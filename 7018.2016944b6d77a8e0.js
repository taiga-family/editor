(self.webpackChunkeditor_demo=self.webpackChunkeditor_demo||[]).push([[7018],{7018:(t,n,e)=>{e.r(n),e.d(n,{default:()=>I});var o=e(3308),i=e(2978),s=e(7222),r=e(7492),a=e(540),c=e(7270),u=e(6610),l=e(4314);let d=(()=>{var t;class n{transform(t){return t.toUpperCase().split(" ").map(([t])=>t).join("").slice(0,2)}}return(t=n).ɵfac=function(n){return new(n||t)},t.ɵpipe=i.EJ8({name:"tuiInitials",type:t,pure:!0,standalone:!0}),n})();var p,m=e(5340),f=e(5180);const g=["container"];function w(t,n){if(1&t){const t=i.RV6();i.j41(0,"button",2,3),i.bIt("click",function(){const n=i.eBV(t).$implicit,e=i.XpG();return i.Njj(e.setMention.emit(n))})("keydown.enter",function(){const n=i.eBV(t).$implicit,e=i.XpG();return i.Njj(e.setMention.emit(n))}),i.EFF(2),i.nrm(3,"tui-avatar",4),i.nI1(4,"tuiInitials"),i.k0s()}if(2&t){const t=n.$implicit;i.R7$(2),i.SpI(" ",t.name," "),i.R7$(1),i.Y8G("src",t.avatar||i.bMT(4,2,t.name))}}class y{constructor(){this.items=[{name:"Alexander Inkin",avatar:"https://taiga-ui.dev/assets/images/avatar.jpg",login:"a.inkin"},{name:"Roman Sedov",avatar:"",login:"r.sedov"}],this.setMention=new i.bkB}getFilteredItems(t,n){return n?.length?t.filter(({name:t,login:e})=>e.toLocaleLowerCase().startsWith(n.toLocaleLowerCase())||t.toLocaleLowerCase().startsWith(n.toLocaleLowerCase())):t}down(t,n){const e=Array.from(this.el?.querySelectorAll("button")??[]),o=n?e[0]:e[e.length-1];this.el?.contains(t.target)||o?.focus()}get el(){return this.container?.nativeElement??null}}(p=y).ɵfac=function(t){return new(t||p)},p.ɵcmp=i.VBU({type:p,selectors:[["mentions"]],viewQuery:function(t,n){if(1&t&&i.GBs(g,5,i.aKT),2&t){let t;i.mGM(t=i.lsd())&&(n.container=t.first)}},hostBindings:function(t,n){1&t&&i.bIt("keydown.arrowUp",function(t){return n.down(t,!1)},!1,i.tSv)("keydown.arrowDown",function(t){return n.down(t,!0)},!1,i.tSv)},inputs:{mentionSuggestions:"mentionSuggestions"},outputs:{setMention:"setMention"},standalone:!0,features:[i.aNF],decls:4,vars:1,consts:[["container",""],["tuiOption","","type","button",3,"click","keydown.enter",4,"ngFor","ngForOf"],["tuiOption","","type","button",3,"click","keydown.enter"],["button",""],["size","s",3,"src"]],template:function(t,n){1&t&&(i.j41(0,"tui-data-list")(1,"div",null,0),i.DNE(3,w,5,4,"button",1),i.k0s()()),2&t&&(i.R7$(3),i.Y8G("ngForOf",n.getFilteredItems(n.items,n.mentionSuggestions)))},dependencies:[u.Sq,m.El,f.uE,f.aO,d],encapsulation:2,changeDetection:0}),(0,c.Cg)([l.PE],y.prototype,"getFilteredItems",null);var v=e(6173),b=e(1333),h=e(7920),k=e(6175);function E(t,n){if(1&t){const t=i.RV6();i.qex(0),i.j41(1,"mentions",5),i.bIt("setMention",function(n){i.eBV(t);const e=i.XpG();return i.Njj(e.setMention(n))}),i.k0s(),i.bVm()}if(2&t){const t=i.XpG();i.R7$(1),i.Y8G("mentionSuggestions",null==t.wysiwyg?null:t.wysiwyg.mentionSuggestions)}}function T(t,n){if(1&t&&(i.qex(0),i.nrm(1,"tui-editor-socket",6),i.bVm()),2&t){const t=i.XpG();i.R7$(1),i.Y8G("content",t.control.value)}}function G(t,n){if(1&t&&(i.qex(0),i.EFF(1),i.bVm()),2&t){const t=i.XpG();i.R7$(1),i.SpI(" ",t.control.value," ")}}let F=(()=>{var t;class n{constructor(){this.isE2E=(0,i.WQX)(r.Hs),this.builtInTools=[a.TuiEditorTool.Undo,a.TuiEditorTool.Size,a.TuiEditorTool.Link],this.control=new s.MJ('\n        <p><span class="my-mention" data-type="mention" data-user="7dabb7f0-099b-4c19-b70c-7a5ebdf53a86">@m.ivanov</span> FYI</p>\n    ')}setMention(t){const n=this.wysiwyg?.editor?.getOriginTiptapEditor();if(!n)return;const e=`<span class="my-mention" data-type="mention" data-user="${crypto.randomUUID()}">@${t.login}</span>&nbsp;`,o=n.state.selection.to,i=n.state.selection.from-(this.wysiwyg?.mentionSuggestions.length??0)-1;n.chain().focus().insertContentAt({from:i,to:o},e).run()}}return(t=n).ɵfac=function(n){return new(n||t)},t.ɵcmp=i.VBU({type:t,selectors:[["ng-component"]],viewQuery:function(t,n){if(1&t&&i.GBs(a.TuiEditor,5),2&t){let t;i.mGM(t=i.lsd())&&(n.wysiwyg=t.first)}},standalone:!0,features:[i.Jv_([(0,a.provideTuiEditor)((0,o.A)(function*(){return Promise.resolve().then(e.bind(e,540)).then(({TuiMention:t})=>t)}))]),i.aNF],decls:11,vars:6,consts:[["placeholder","Required text *",3,"formControl","tools","tuiDropdownOpen"],[4,"tuiTextfieldDropdown"],[3,"closeOthers"],[3,"tuiAccordion"],[4,"tuiItem"],[3,"mentionSuggestions","setMention"],[3,"content"]],template:function(t,n){if(1&t&&(i.j41(0,"tui-editor",0),i.DNE(1,E,2,1,"ng-container",1),i.k0s(),i.j41(2,"tui-accordion",2)(3,"button",3),i.EFF(4,"HTML"),i.k0s(),i.j41(5,"tui-expand"),i.DNE(6,T,2,1,"ng-container",4),i.k0s(),i.j41(7,"button",3),i.EFF(8,"Text"),i.k0s(),i.j41(9,"tui-expand"),i.DNE(10,G,2,1,"ng-container",4),i.k0s()()),2&t){let t;i.Y8G("formControl",n.control)("tools",n.builtInTools)("tuiDropdownOpen",null!==(t=null==n.wysiwyg?null:n.wysiwyg.isMentionMode)&&void 0!==t&&t),i.R7$(2),i.Y8G("closeOthers",!1),i.R7$(1),i.Y8G("tuiAccordion",n.isE2E),i.R7$(4),i.Y8G("tuiAccordion",n.isE2E)}},dependencies:[y,s.X1,s.BC,s.l_,v.o3,v.S3,b.d,h.K,a.TuiEditor,a.TuiEditorSocket,k.U9],styles:[".my-mention{display:inline-block;background:var(--tui-autofill);outline:.0625rem solid var(--tui-background-accent-opposite-hover);border-radius:.4rem;padding:.1rem .3rem;cursor:default;margin:1px}\n"],encapsulation:2,changeDetection:0}),n})();const I=F}}]);